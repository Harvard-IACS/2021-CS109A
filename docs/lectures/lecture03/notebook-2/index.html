<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8"/>
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta
            name="description"
            content="Fall 2021 - Harvard University, Institute for Applied Computational Science. Lecture 3: Introduction to Regression kNN and Linear Regression"
    />
    <meta name="author" content="Pavlos Protopapas"/>
    <meta
            name="keywords"
            content="Knn, Knn Regression, MSE, Data Plotting"
    />

    <!-- Bootstrap CSS -->
    <link
            rel="stylesheet"
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"
            integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB"
            crossorigin="anonymous"
    />

    <link
            rel="stylesheet"
            href="https://use.fontawesome.com/releases/v5.2.0/css/all.css"
            integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ"
            crossorigin="anonymous"
    />

    <link
            href="https://fonts.googleapis.com/css?family=Roboto+Condensed|Roboto:300,400,700"
            rel="stylesheet"
    />

    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css"
    />

    <link
            rel="stylesheet"
            href="../../../style/tipuesearch/tipuesearch.css"
    />

    <link
            rel="shortcut icon"
            type="image/x-icon"
            href="../../../style/images/favicon.ico"
    />
    <link rel="stylesheet" href="../../../style/css/iacs.css"/>

    <title>Harvard CS109A | Lecture 3: Introduction to Regression kNN and Linear Regression</title>

    <style>
        .navbar {
            background-color: #c90016
        }
    </style>
</head>
<body>
<nav class="navbar navbar-dark navbar-expand-md">
    <div class="container">
        <a class="navbar-brand" href="../../..">
            <img
                    class="navbar-brand-logo"
                    src="../../../style/images/logo.png"
            />
            <h3 class="course-title">CS109A</h3>
        </a>
        <button
                class="navbar-toggler"
                type="button"
                data-toggle="collapse"
                data-target="#navbarsDefault"
                aria-controls="navbarsDefault"
                aria-expanded="false"
                aria-label="Toggle navigation"
        >
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarsDefault">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/syllabus.html">Syllabus</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/schedule.html">Schedule</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/materials.html">Materials</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/faq.html">FAQ</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/preparation.html">Preparation</a>
                </li>
                <form
                        class="form-inline my-2"
                        action="../../../search.html"
                        onsubmit="return validateForm(this.elements['q'].value);"
                >
                    <div class="input-group input-group-sm">
                        <input
                                class="form-control"
                                type="text"
                                name="q"
                                placeholder="Search Topic"
                        />
                        <div class="input-group-append">
                            <button class="btn btn-default" type="submit">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                </form>
            </ul>
        </div>
        <!-- .collapse navbar-collapse -->
    </div>
    <!-- .container -->
</nav>
<main id="content" class="container">
    <div>
        <div class="float-left">
            <p>
                Key Word(s): <a href="../../../pages/materials.html#Knn"
            >Knn</a
            >, <a href="../../../pages/materials.html#Knn Regression"
            >Knn Regression</a
            >, <a href="../../../pages/materials.html#MSE"
            >MSE</a
            >, <a href="../../../pages/materials.html#Data Plotting"
            >Data Plotting</a
            ></p>
        </div>
        <div class="float-right">
            <a href="../../../lectures/lecture03/notebook/s1_exa2_challenge.ipynb">
                Download Notebook <i class="fas fa-download"></i>
            </a>
        </div>
    </div>
    <br/>
    <hr/>
    <style type="text/css">.highlight .hll {
        background-color: var(--jp-cell-editor-active-background)
    }

    .highlight {
        background: var(--jp-cell-editor-background);
        color: var(--jp-mirror-editor-variable-color)
    }

    .highlight .c {
        color: var(--jp-mirror-editor-comment-color);
        font-style: italic
    }

    /* Comment */
    .highlight .err {
        color: var(--jp-mirror-editor-error-color)
    }

    /* Error */
    .highlight .k {
        color: var(--jp-mirror-editor-keyword-color);
        font-weight: bold
    }

    /* Keyword */
    .highlight .o {
        color: var(--jp-mirror-editor-operator-color);
        font-weight: bold
    }

    /* Operator */
    .highlight .p {
        color: var(--jp-mirror-editor-punctuation-color)
    }

    /* Punctuation */
    .highlight .ch {
        color: var(--jp-mirror-editor-comment-color);
        font-style: italic
    }

    /* Comment.Hashbang */
    .highlight .cm {
        color: var(--jp-mirror-editor-comment-color);
        font-style: italic
    }

    /* Comment.Multiline */
    .highlight .cp {
        color: var(--jp-mirror-editor-comment-color);
        font-style: italic
    }

    /* Comment.Preproc */
    .highlight .cpf {
        color: var(--jp-mirror-editor-comment-color);
        font-style: italic
    }

    /* Comment.PreprocFile */
    .highlight .c1 {
        color: var(--jp-mirror-editor-comment-color);
        font-style: italic
    }

    /* Comment.Single */
    .highlight .cs {
        color: var(--jp-mirror-editor-comment-color);
        font-style: italic
    }

    /* Comment.Special */
    .highlight .kc {
        color: var(--jp-mirror-editor-keyword-color);
        font-weight: bold
    }

    /* Keyword.Constant */
    .highlight .kd {
        color: var(--jp-mirror-editor-keyword-color);
        font-weight: bold
    }

    /* Keyword.Declaration */
    .highlight .kn {
        color: var(--jp-mirror-editor-keyword-color);
        font-weight: bold
    }

    /* Keyword.Namespace */
    .highlight .kp {
        color: var(--jp-mirror-editor-keyword-color);
        font-weight: bold
    }

    /* Keyword.Pseudo */
    .highlight .kr {
        color: var(--jp-mirror-editor-keyword-color);
        font-weight: bold
    }

    /* Keyword.Reserved */
    .highlight .kt {
        color: var(--jp-mirror-editor-keyword-color);
        font-weight: bold
    }

    /* Keyword.Type */
    .highlight .m {
        color: var(--jp-mirror-editor-number-color)
    }

    /* Literal.Number */
    .highlight .s {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String */
    .highlight .ow {
        color: var(--jp-mirror-editor-operator-color);
        font-weight: bold
    }

    /* Operator.Word */
    .highlight .w {
        color: var(--jp-mirror-editor-variable-color)
    }

    /* Text.Whitespace */
    .highlight .mb {
        color: var(--jp-mirror-editor-number-color)
    }

    /* Literal.Number.Bin */
    .highlight .mf {
        color: var(--jp-mirror-editor-number-color)
    }

    /* Literal.Number.Float */
    .highlight .mh {
        color: var(--jp-mirror-editor-number-color)
    }

    /* Literal.Number.Hex */
    .highlight .mi {
        color: var(--jp-mirror-editor-number-color)
    }

    /* Literal.Number.Integer */
    .highlight .mo {
        color: var(--jp-mirror-editor-number-color)
    }

    /* Literal.Number.Oct */
    .highlight .sa {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Affix */
    .highlight .sb {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Backtick */
    .highlight .sc {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Char */
    .highlight .dl {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Delimiter */
    .highlight .sd {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Doc */
    .highlight .s2 {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Double */
    .highlight .se {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Escape */
    .highlight .sh {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Heredoc */
    .highlight .si {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Interpol */
    .highlight .sx {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Other */
    .highlight .sr {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Regex */
    .highlight .s1 {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Single */
    .highlight .ss {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Symbol */
    .highlight .il {
        color: var(--jp-mirror-editor-number-color)
    }

    /* Literal.Number.Integer.Long */</style>
    <body>
    <div class="jp-Cell-inputWrapper">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
            <h2 id="Title-:">Title :<a class="anchor-link" href="#Title-:">&#182;</a></h2>
            <p>Exercise: Simple kNN Regression</p>
            <h2 id="Description-:">Description :<a class="anchor-link" href="#Description-:">&#182;</a></h2>
            <p>The goal of this exercise is to <strong>re-create the plots</strong> given below. You would have come
                across these graphs in the lecture as well.</p>
            <p><img src="../fig/fig2.png" style="width: 500px;">
                <img src="../fig/fig3.png" style="width: 500px;"></p>
            <h2 id="Data-Description:">Data Description:<a class="anchor-link" href="#Data-Description:">&#182;</a></h2>
            <h2 id="Instructions:">Instructions:<a class="anchor-link" href="#Instructions:">&#182;</a></h2>
            <p><u>Part 1:</u> KNN by hand for k=1</p>
            <ul>
                <li>Read the Advertisement data.</li>
                <li>Get a subset of the data from row 5 to row 13.</li>
                <li>Apply the kNN algorithm by hand and plot the first graph as given above.</li>
            </ul>
            <p><u>Part 2:</u> Using sklearn package</p>
            <ul>
                <li>Read the Advertisement dataset.</li>
                <li>Split the data into train and test sets using the <code>train_test_split()</code> function.</li>
                <li>Set <code>k_list</code> as the possible k values ranging from 1 to 70.</li>
                <li>For each value of <code>k</code> in <code>k_list</code>:
                    <ul>
                        <li>Use <code>sklearn KNearestNeighbors()</code> to fit train data.</li>
                        <li>Predict on the test data.</li>
                        <li>Use the helper code to get the second plot above for k=1,10,70.</li>
                    </ul>
                </li>
            </ul>
            <h2 id="Hints:">Hints:<a class="anchor-link" href="#Hints:">&#182;</a></h2>
            <p><a href="https://numpy.org/doc/stable/reference/generated/numpy.argsort.html" target="_blank">np.argsort()</a>
                Returns the indices that would sort an array.</p>
            <p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.iloc.html"
                  target="_blank">df.iloc[]</a>
                Returns a subset of the dataframe that is contained in the column range passed as the argument.</p>
            <p><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html" target="_blank">plt.plot()</a>
                Plot y versus x as lines and/or markers.</p>
            <p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.values.html"
                  target="_blank">df.values</a>
                Returns a Numpy representation of the DataFrame.</p>
            <p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.idxmin.html"
                  target="_blank">pd.idxmin()</a>
                Returns index of the first occurrence of minimum over requested axis.</p>
            <p>
                <a href="http://pageperso.lif.univ-mrs.fr/~francois.denis/IAAM1/numpy-html-1.14.0/reference/generated/numpy.ndarray.min.html"
                   target="_blank">np.min()</a>
                Returns the minimum along a given axis.</p>
            <p><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.max.html" target="_blank">np.max()</a>
                Returns the maximum along a given axis.</p>
            <p>
                <a href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsRegressor.html#sklearn.neighbors.KNeighborsRegressor.fit"
                   target="_blank">model.fit()</a>
                Fit the k-nearest neighbors regressor from the training dataset.</p>
            <p>
                <a href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsRegressor.html#sklearn.neighbors.KNeighborsRegressor.predict"
                   target="_blank">model.predict()</a>
                Predict the target for the provided data.</p>
            <p><a href="https://numpy.org/devdocs/reference/generated/numpy.zeros.html" target="_blank">np.zeros()</a>
                Returns a new array of given shape and type, filled with zeros.</p>
            <p><a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html"
                  target="_blank">train_test_split(X,y)</a>
                Split arrays or matrices into random train and test subsets.</p>
            <p><a href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html" target="_blank">np.linspace()</a>
                Returns evenly spaced numbers over a specified interval.</p>
            <p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsRegressor.html"
                  target="_blank">KNeighborsRegressor(n_neighbors=k_value)</a>
                Regression-based on k-nearest neighbors.</p>
            <p><strong>Note:</strong> This exercise is auto-graded, hence please remember to set all the parameters to
                the values mentioned in the scaffold before marking.</p>

        </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[2]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import required libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span
                                    class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span
                                    class="n">train_test_split</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[3]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Read the data from the file &quot;Advertising.csv&quot;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;Advertising.csv&#39;</span>
<span class="n">df_adv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span
                                    class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[4]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Take a quick look of the dataset</span>
<span class="n">df_adv</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="jp-Cell-outputWrapper">


            <div class="jp-OutputArea jp-Cell-outputArea">

                <div class="jp-OutputArea-child">


                    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[4]:</div>


                    <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
                         data-mime-type="text/html">
                        <div>
                            <style scoped>
                                .dataframe tbody tr th:only-of-type {
                                    vertical-align: middle;
                                }

                                .dataframe tbody tr th {
                                    vertical-align: top;
                                }

                                .dataframe thead th {
                                    text-align: right;
                                }
                            </style>
                            <table border="1" class="dataframe">
                                <thead>
                                <tr style="text-align: right;">
                                    <th></th>
                                    <th>TV</th>
                                    <th>Radio</th>
                                    <th>Newspaper</th>
                                    <th>Sales</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <th>0</th>
                                    <td>230.1</td>
                                    <td>37.8</td>
                                    <td>69.2</td>
                                    <td>22.1</td>
                                </tr>
                                <tr>
                                    <th>1</th>
                                    <td>44.5</td>
                                    <td>39.3</td>
                                    <td>45.1</td>
                                    <td>10.4</td>
                                </tr>
                                <tr>
                                    <th>2</th>
                                    <td>17.2</td>
                                    <td>45.9</td>
                                    <td>69.3</td>
                                    <td>9.3</td>
                                </tr>
                                <tr>
                                    <th>3</th>
                                    <td>151.5</td>
                                    <td>41.3</td>
                                    <td>58.5</td>
                                    <td>18.5</td>
                                </tr>
                                <tr>
                                    <th>4</th>
                                    <td>180.8</td>
                                    <td>10.8</td>
                                    <td>58.4</td>
                                    <td>12.9</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                </div>

            </div>

        </div>

    </div>
    <div class="jp-Cell-inputWrapper">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
            <h2 id="Part-1:-KNN-by-hand-for-$k=1$">Part 1: KNN by hand for $k=1$<a class="anchor-link"
                                                                                   href="#Part-1:-KNN-by-hand-for-$k=1$">&#182;</a>
            </h2>
        </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[5]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get a subset of the data i.e. rows 5 to 13</span>
<span class="c1"># Use the TV column as the predictor</span>
<span class="n">x_true</span> <span class="o">=</span> <span class="n">df_adv</span><span class="o">.</span><span
                                    class="n">TV</span><span class="o">.</span><span class="n">iloc</span><span
                                    class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">13</span><span
                                    class="p">]</span>

<span class="c1"># Use the Sales column as the response</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">df_adv</span><span class="o">.</span><span
                                    class="n">Sales</span><span class="o">.</span><span class="n">iloc</span><span
                                    class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">13</span><span
                                    class="p">]</span>

<span class="c1"># Sort the data to get indices ordered from lowest to highest TV values</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span
                                    class="p">(</span><span class="n">x_true</span><span class="p">)</span><span
                                    class="o">.</span><span class="n">values</span>

<span class="c1"># Get the predictor data in the order given by idx above</span>
<span class="n">x_true</span>  <span class="o">=</span> <span class="n">x_true</span><span class="o">.</span><span
                                    class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span
                                    class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Get the response data in the order given by idx above</span>
<span class="n">y_true</span>  <span class="o">=</span> <span class="n">y_true</span><span class="o">.</span><span
                                    class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span
                                    class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[6]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### edTest(test_findnearest) ###</span>
<span class="c1"># Define a function that finds the index of the nearest neighbor </span>
<span class="c1"># and returns the value of the nearest neighbor.  </span>
<span class="c1"># Note that this is just for k = 1 where the distance function is </span>
<span class="c1"># simply the absolute value.</span>

<span class="k">def</span> <span class="nf">find_nearest</span><span class="p">(</span><span class="n">array</span><span
                                    class="p">,</span><span class="n">value</span><span class="p">):</span>
    
    <span class="c1"># Hint: To find idx, use .idxmin() function on the series</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span
                                    class="n">Series</span><span class="p">(</span><span class="n">np</span><span
                                    class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">array</span><span
                                    class="o">-</span><span class="n">value</span><span class="p">))</span><span
                                    class="o">.</span><span class="n">idxmin</span><span class="p">()</span>

    <span class="c1"># Return the nearest neighbor index and value</span>
    <span class="k">return</span> <span class="n">idx</span><span class="p">,</span> <span class="n">array</span><span
                                    class="p">[</span><span class="n">idx</span><span class="p">]</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[7]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create some synthetic x-values (might not be in the actual dataset)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span
                                    class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span
                                    class="p">(</span><span class="n">x_true</span><span class="p">),</span> <span
                                    class="n">np</span><span class="o">.</span><span class="n">max</span><span
                                    class="p">(</span><span class="n">x_true</span><span class="p">))</span>

<span class="c1"># Initialize the y-values for the length of the synthetic x-values to zero</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                    class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span
                                    class="p">(</span><span class="n">x</span><span class="p">)))</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[8]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Apply the KNN algorithm to predict the y-value for the given x value</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">xi</span> <span class="ow">in</span> <span
                                    class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span
                                    class="p">):</span>

    <span class="c1"># Get the Sales values closest to the given x value</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span
                                    class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">find_nearest</span><span
                                    class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xi</span> <span
                                    class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell-inputWrapper">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
            <h3 id="Plotting-the-data">Plotting the data<a class="anchor-link" href="#Plotting-the-data">&#182;</a></h3>
        </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[12]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Plot the synthetic data along with the predictions    </span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span
                                    class="n">x</span><span class="p">,</span> <span class="n">y</span><span
                                    class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">)</span>

<span class="c1"># Plot the original data using black x&#39;s.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_true</span><span
                                    class="p">,</span> <span class="n">Y_true</span><span class="p">,</span> <span
                                    class="s1">&#39;kx&#39;</span><span class="p">)</span>

<span class="c1"># Set the title and axis labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;TV vs Sales&#39;</span><span
                                    class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;TV budget in $1000&#39;</span><span
                                    class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sales in $1000&#39;</span><span
                                    class="p">)</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="jp-Cell-outputWrapper">


            <div class="jp-OutputArea jp-Cell-outputArea">

                <div class="jp-OutputArea-child">


                    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


                    <div class="jp-RenderedImage jp-OutputArea-output ">
                        <img src="data:image/png;base64,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
"
                        >
                    </div>

                </div>

                <div class="jp-OutputArea-child">


                    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


                    <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_30/3566749308.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> 
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span class="ansi-red-fg"># Plot the original data using black x&#39;s.</span>
<span class="ansi-green-fg">----&gt; 5</span><span class="ansi-red-fg"> </span>plt<span class="ansi-blue-fg">.</span>plot<span
        class="ansi-blue-fg">(</span>x_true<span class="ansi-blue-fg">,</span> Y_true<span class="ansi-blue-fg">,</span> <span
        class="ansi-blue-fg">&#39;kx&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span> 
<span class="ansi-green-intense-fg ansi-bold">      7</span> <span
        class="ansi-red-fg"># Set the title and axis labels</span>

<span class="ansi-red-fg">NameError</span>: name &#39;Y_true&#39; is not defined</pre>
                    </div>
                </div>

            </div>

        </div>

    </div>
    <div class="jp-Cell-inputWrapper">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
            <h2 id="Part-2:-KNN-for-$k\ge1$-using-sklearn">Part 2: KNN for $k\ge1$ using sklearn<a class="anchor-link"
                                                                                                   href="#Part-2:-KNN-for-$k\ge1$-using-sklearn">&#182;</a>
            </h2>
        </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[0]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Read the data from the file &quot;Advertising.csv&quot;</span>
<span class="n">data_filename</span> <span class="o">=</span> <span class="s1">&#39;Advertising.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span
                                    class="p">(</span><span class="n">data_filename</span><span class="p">)</span>

<span class="c1"># Set &#39;TV&#39; as the &#39;predictor variable&#39;   </span>
<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span
                                    class="n">___</span><span class="p">]]</span>

<span class="c1"># Set &#39;Sales&#39; as the response variable &#39;y&#39; </span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span
                                    class="n">___</span><span class="p">]</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[0]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### edTest(test_shape) ###</span>

<span class="c1"># Split the dataset in training and testing with 60% training set </span>
<span class="c1"># and 40% testing set with random state = 42</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span
                                    class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span
                                    class="o">=</span> <span class="n">train_test_split</span><span
                                    class="p">(</span><span class="n">___</span><span class="p">,</span> <span
                                    class="n">___</span><span class="p">,</span> <span class="n">train_size</span><span
                                    class="o">=</span><span class="n">___</span><span class="p">,</span><span class="n">random_state</span><span
                                    class="o">=</span><span class="n">___</span><span class="p">)</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[0]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span
                                class="c1">### edTest(test_nums) ###</span>

<span class="c1"># Choose the minimum k value based on the instructions given on the left</span>
<span class="n">k_value_min</span> <span class="o">=</span> <span class="n">___</span>

<span class="c1"># Choose the maximum k value based on the instructions given on the left</span>
<span class="n">k_value_max</span> <span class="o">=</span> <span class="n">___</span>


<span class="c1"># Create a list of integer k values betwwen k_value_min and k_value_max using linspace</span>
<span class="n">k_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span
                                    class="p">(</span><span class="n">k_value_min</span><span class="p">,</span> <span
                                    class="n">k_value_max</span><span class="p">,</span> <span class="mi">70</span><span
                                    class="p">)</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[0]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Set the grid to plot the values</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span
                                    class="o">.</span><span class="n">subplots</span><span class="p">(</span><span
                                    class="n">figsize</span><span class="o">=</span><span class="p">(</span><span
                                    class="mi">10</span><span class="p">,</span><span class="mi">6</span><span
                                    class="p">))</span>

<span class="c1"># Variable used to alter the linewidth of each plot</span>
<span class="n">j</span><span class="o">=</span><span class="mi">0</span>

<span class="c1"># Loop over all the k values</span>
<span class="k">for</span> <span class="n">k_value</span> <span class="ow">in</span> <span class="n">k_list</span><span
                                    class="p">:</span>
    
    <span class="c1"># Creating a kNN Regression model </span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span
                                    class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span
                                    class="nb">int</span><span class="p">(</span><span class="n">___</span><span
                                    class="p">))</span>
    
    <span class="c1"># Fitting the regression model on the training data </span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span
                                    class="n">___</span><span class="p">,</span><span class="n">___</span><span
                                    class="p">)</span>
    
    <span class="c1"># Use the trained model to predict on the test data </span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span
                                    class="n">predict</span><span class="p">(</span><span class="n">___</span><span
                                    class="p">)</span>
    
    <span class="c1"># Helper code to plot the data along with the model predictions</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span
                                    class="s1">&#39;grey&#39;</span><span class="p">,</span><span
                                    class="s1">&#39;r&#39;</span><span class="p">,</span><span
                                    class="s1">&#39;b&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">k_value</span> <span class="ow">in</span> <span class="p">[</span><span
                                    class="mi">1</span><span class="p">,</span><span class="mi">10</span><span
                                    class="p">,</span><span class="mi">70</span><span class="p">]:</span>
        <span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                    class="n">linspace</span><span class="p">(</span><span class="n">x</span><span
                                    class="o">.</span><span class="n">min</span><span class="p">(),</span><span
                                    class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span
                                    class="mi">100</span><span class="p">)</span>
        <span class="n">ypreds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span
                                    class="n">predict</span><span class="p">(</span><span class="n">xvals</span><span
                                    class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span
                                    class="n">xvals</span><span class="p">,</span> <span class="n">ypreds</span><span
                                    class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span
                                    class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span
                                    class="s1">&#39;k = </span><span class="si">{</span><span class="nb">int</span><span
                                    class="p">(</span><span class="n">k_value</span><span class="p">)</span><span
                                    class="si">}</span><span class="s1">&#39;</span><span class="p">,</span><span
                                    class="n">linewidth</span><span class="o">=</span><span class="n">j</span><span
                                    class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span> <span
                                    class="o">=</span> <span class="n">colors</span><span class="p">[</span><span
                                    class="n">j</span><span class="p">])</span>
        <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
        
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span
                                    class="o">=</span><span class="s1">&#39;lower right&#39;</span><span
                                    class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span
                                    class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train</span><span
                                    class="p">,</span> <span class="n">y_train</span><span class="p">,</span><span
                                    class="s1">&#39;x&#39;</span><span class="p">,</span><span
                                    class="n">label</span><span class="o">=</span><span
                                    class="s1">&#39;train&#39;</span><span class="p">,</span><span
                                    class="n">color</span><span class="o">=</span><span
                                    class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span
                                    class="s1">&#39;TV budget in $1000&#39;</span><span class="p">,</span><span
                                    class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span
                                    class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span
                                    class="s1">&#39;Sales in $1000&#39;</span><span class="p">,</span><span class="n">fontsize</span><span
                                    class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell-inputWrapper">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
            <h4 id="&#9208;-In-the-plotting-code-above,-re-run-ax.plot(x_train,-y_train,'x',label='train',color='k')-with-x_test-and-y_test-instead.-According-to-you,-which-k-value-is-the-best-and-why?">
                &#9208; In the plotting code above, re-run <code>ax.plot(x_train,
                y_train,'x',label='train',color='k')</code> with <code>x_test</code> and <code>y_test</code> instead.
                According to you, which k value is the best and why?<a class="anchor-link"
                                                                       href="#&#9208;-In-the-plotting-code-above,-re-run-ax.plot(x_train,-y_train,'x',label='train',color='k')-with-x_test-and-y_test-instead.-According-to-you,-which-k-value-is-the-best-and-why?">&#182;</a>
            </h4>
        </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[0]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### edTest(test_chow1) ###</span>
<span class="c1"># Type your answer within in the quotes given</span>
<span class="n">answer1</span> <span class="o">=</span> <span class="s1">&#39;___&#39;</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>


    </body>
    <script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
        var mathjaxscript = document.createElement('script');
        mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
        mathjaxscript.type = 'text/javascript';
        mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
        mathjaxscript[(window.opera ? "innerHTML" : "text")] =
            "MathJax.Hub.Config({" +
            "    config: ['MMLorHTML.js']," +
            "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
            "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
            "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
            "    displayAlign: 'center'," +
            "    displayIndent: '0em'," +
            "    showMathMenu: true," +
            "    tex2jax: { " +
            "        inlineMath: [ ['$','$'] ], " +
            "        displayMath: [ ['$$','$$'] ]," +
            "        processEscapes: true," +
            "        preview: 'TeX'," +
            "    }, " +
            "    'HTML-CSS': { " +
            " linebreaks: { automatic: true, width: '95% container' }, " +
            "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
            "    } " +
            "}); ";
        (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
    }
    </script>
</main>

<footer class="footer">
    <div class="container">
    <span class="text-muted">Copyright 2018 &copy;
      <a class="text-muted" href="https://iacs.seas.harvard.edu/">Institute for Applied Computational Science</a>
    </span>
    </div>
</footer>     <!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script
        src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"
></script>
<script
        src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"
        integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T"
        crossorigin="anonymous"
></script>
</body>
</html>