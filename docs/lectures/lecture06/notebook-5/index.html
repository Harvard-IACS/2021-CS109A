<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8"/>
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta
            name="description"
            content="Fall 2021 - Harvard University, Institute for Applied Computational Science. Lecture 6: Regularization Ridge and Lasso Regression"
    />
    <meta name="author" content="Pavlos Protopapas"/>
    <meta
            name="keywords"
            content="Lasso, Ridge, Error, Bias, Variance, Regularization, Generalization"
    />

    <!-- Bootstrap CSS -->
    <link
            rel="stylesheet"
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"
            integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB"
            crossorigin="anonymous"
    />

    <link
            rel="stylesheet"
            href="https://use.fontawesome.com/releases/v5.2.0/css/all.css"
            integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ"
            crossorigin="anonymous"
    />

    <link
            href="https://fonts.googleapis.com/css?family=Roboto+Condensed|Roboto:300,400,700"
            rel="stylesheet"
    />

    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css"
    />

    <link
            rel="stylesheet"
            href="../../../style/tipuesearch/tipuesearch.css"
    />

    <link
            rel="shortcut icon"
            type="image/x-icon"
            href="../../../style/images/favicon.ico"
    />
    <link rel="stylesheet" href="../../../style/css/iacs.css"/>

    <title>Harvard CS109A | Lecture 6: Regularization Ridge and Lasso Regression</title>

    <style>
        .navbar {
            background-color: #c90016
        }
    </style>
</head>
<body>
<nav class="navbar navbar-dark navbar-expand-md">
    <div class="container">
        <a class="navbar-brand" href="../../..">
            <img
                    class="navbar-brand-logo"
                    src="../../../style/images/logo.png"
            />
            <h3 class="course-title">CS109A</h3>
        </a>
        <button
                class="navbar-toggler"
                type="button"
                data-toggle="collapse"
                data-target="#navbarsDefault"
                aria-controls="navbarsDefault"
                aria-expanded="false"
                aria-label="Toggle navigation"
        >
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarsDefault">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/syllabus.html">Syllabus</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/schedule.html">Schedule</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/materials.html">Materials</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/faq.html">FAQ</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="../../../pages/preparation.html">Preparation</a>
                </li>
                <form
                        class="form-inline my-2"
                        action="../../../search.html"
                        onsubmit="return validateForm(this.elements['q'].value);"
                >
                    <div class="input-group input-group-sm">
                        <input
                                class="form-control"
                                type="text"
                                name="q"
                                placeholder="Search Topic"
                        />
                        <div class="input-group-append">
                            <button class="btn btn-default" type="submit">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                </form>
            </ul>
        </div>
        <!-- .collapse navbar-collapse -->
    </div>
    <!-- .container -->
</nav>
<main id="content" class="container">
    <div>
        <div class="float-left">
            <p>
                Key Word(s): <a href="../../../pages/materials.html#Lasso"
            >Lasso</a
            >, <a href="../../../pages/materials.html#Ridge"
            >Ridge</a
            >, <a href="../../../pages/materials.html#Error"
            >Error</a
            >, <a href="../../../pages/materials.html#Bias"
            >Bias</a
            >, <a href="../../../pages/materials.html#Variance"
            >Variance</a
            >, <a href="../../../pages/materials.html#Regularization"
            >Regularization</a
            >, <a href="../../../pages/materials.html#Generalization"
            >Generalization</a
            ></p>
        </div>
        <div class="float-right">
            <a href="../../../lectures/lecture06/notebook/reg_with_cv.ipynb">
                Download Notebook <i class="fas fa-download"></i>
            </a>
        </div>
    </div>
    <br/>
    <hr/>
    <style type="text/css">.highlight .hll {
        background-color: var(--jp-cell-editor-active-background)
    }

    .highlight {
        background: var(--jp-cell-editor-background);
        color: var(--jp-mirror-editor-variable-color)
    }

    .highlight .c {
        color: var(--jp-mirror-editor-comment-color);
        font-style: italic
    }

    /* Comment */
    .highlight .err {
        color: var(--jp-mirror-editor-error-color)
    }

    /* Error */
    .highlight .k {
        color: var(--jp-mirror-editor-keyword-color);
        font-weight: bold
    }

    /* Keyword */
    .highlight .o {
        color: var(--jp-mirror-editor-operator-color);
        font-weight: bold
    }

    /* Operator */
    .highlight .p {
        color: var(--jp-mirror-editor-punctuation-color)
    }

    /* Punctuation */
    .highlight .ch {
        color: var(--jp-mirror-editor-comment-color);
        font-style: italic
    }

    /* Comment.Hashbang */
    .highlight .cm {
        color: var(--jp-mirror-editor-comment-color);
        font-style: italic
    }

    /* Comment.Multiline */
    .highlight .cp {
        color: var(--jp-mirror-editor-comment-color);
        font-style: italic
    }

    /* Comment.Preproc */
    .highlight .cpf {
        color: var(--jp-mirror-editor-comment-color);
        font-style: italic
    }

    /* Comment.PreprocFile */
    .highlight .c1 {
        color: var(--jp-mirror-editor-comment-color);
        font-style: italic
    }

    /* Comment.Single */
    .highlight .cs {
        color: var(--jp-mirror-editor-comment-color);
        font-style: italic
    }

    /* Comment.Special */
    .highlight .kc {
        color: var(--jp-mirror-editor-keyword-color);
        font-weight: bold
    }

    /* Keyword.Constant */
    .highlight .kd {
        color: var(--jp-mirror-editor-keyword-color);
        font-weight: bold
    }

    /* Keyword.Declaration */
    .highlight .kn {
        color: var(--jp-mirror-editor-keyword-color);
        font-weight: bold
    }

    /* Keyword.Namespace */
    .highlight .kp {
        color: var(--jp-mirror-editor-keyword-color);
        font-weight: bold
    }

    /* Keyword.Pseudo */
    .highlight .kr {
        color: var(--jp-mirror-editor-keyword-color);
        font-weight: bold
    }

    /* Keyword.Reserved */
    .highlight .kt {
        color: var(--jp-mirror-editor-keyword-color);
        font-weight: bold
    }

    /* Keyword.Type */
    .highlight .m {
        color: var(--jp-mirror-editor-number-color)
    }

    /* Literal.Number */
    .highlight .s {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String */
    .highlight .ow {
        color: var(--jp-mirror-editor-operator-color);
        font-weight: bold
    }

    /* Operator.Word */
    .highlight .w {
        color: var(--jp-mirror-editor-variable-color)
    }

    /* Text.Whitespace */
    .highlight .mb {
        color: var(--jp-mirror-editor-number-color)
    }

    /* Literal.Number.Bin */
    .highlight .mf {
        color: var(--jp-mirror-editor-number-color)
    }

    /* Literal.Number.Float */
    .highlight .mh {
        color: var(--jp-mirror-editor-number-color)
    }

    /* Literal.Number.Hex */
    .highlight .mi {
        color: var(--jp-mirror-editor-number-color)
    }

    /* Literal.Number.Integer */
    .highlight .mo {
        color: var(--jp-mirror-editor-number-color)
    }

    /* Literal.Number.Oct */
    .highlight .sa {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Affix */
    .highlight .sb {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Backtick */
    .highlight .sc {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Char */
    .highlight .dl {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Delimiter */
    .highlight .sd {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Doc */
    .highlight .s2 {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Double */
    .highlight .se {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Escape */
    .highlight .sh {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Heredoc */
    .highlight .si {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Interpol */
    .highlight .sx {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Other */
    .highlight .sr {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Regex */
    .highlight .s1 {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Single */
    .highlight .ss {
        color: var(--jp-mirror-editor-string-color)
    }

    /* Literal.String.Symbol */
    .highlight .il {
        color: var(--jp-mirror-editor-number-color)
    }

    /* Literal.Number.Integer.Long */</style>
    <body>
    <div class="jp-Cell-inputWrapper">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
            <h2 id="Title-:">Title :<a class="anchor-link" href="#Title-:">&#182;</a></h2>
            <p>Exercise: Regularization with Cross-validation</p>
            <h2 id="Description-:">Description :<a class="anchor-link" href="#Description-:">&#182;</a></h2>
            <p>The aim of this exercise is to understand regularization with cross-validation.</p>
            <p><img src="../fig/fig1.png" style="width: 500px;"></p>
            <h2 id="Data-Description:">Data Description:<a class="anchor-link" href="#Data-Description:">&#182;</a></h2>
            <h2 id="Instructions:">Instructions:<a class="anchor-link" href="#Instructions:">&#182;</a></h2>
            <ul>
                <li>Initialising the required parameters for this exercise. This can be viewed in the scaffold.</li>
                <li>Read the data file <code>polynomial50.csv</code> and assign the predictor and response variables.
                </li>
                <li>Use the helper code to visualise the data.</li>
                <li>Define a function <code>reg_with_validation</code> that performs Ridge regularization by taking a
                    random_state parameter.
                    <ul>
                        <li>Split the data into train and validation sets by specifying the random_state.</li>
                        <li>Compute the polynomial features for the train and validation sets.</li>
                        <li>Run a loop for the alpha values. Within the loop:
                            <ul>
                                <li>Initialise the Ridge regression model with the specified alpha.</li>
                                <li>Fit the model on the training data and predict and on the train and validation
                                    set.
                                </li>
                                <li>Compute the MSE of the train and validation prediction.</li>
                                <li>Store these values in lists.</li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>Run reg_with_validation for varying random states and plot a graph that depicts the best alpha value
                    and the best MSE. The graph will be similar to the one given above.
                </li>
                <li>Define a function reg_with_cross_validation that performs Ridge regularization with cross-validation
                    by taking a random_state parameter.
                    <ul>
                        <li>Sample the data using the specified random state.</li>
                        <li>Assign the predictor and response variables using the sampled data.</li>
                        <li>Run a loop for the alpha values. Within the loop:
                            <ul>
                                <li>Initialise the Ridge regression model with the specified alpha.</li>
                                <li>Fit the model on the entire data and using cross-validation with 5 folds.</li>
                                <li>Get the train and validation MSEs by taking their mean.</li>
                                <li>Store these values in lists.</li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>Run <code>reg_with_cross_validation</code> for varying random states and plot a graph that depicts
                    the best alpha value and the best MSE.
                </li>
                <li>Use the helper code given to print your best MSEs in the case of simple validation and
                    cross-validation for different random states.
                </li>
            </ul>
            <h2 id="Hints:">Hints:<a class="anchor-link" href="#Hints:">&#182;</a></h2>
            <p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.sample.html"
                  target="_blank">df.sample()</a>
                Returns a random sample of items from an axis of the object.</p>
            <p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_validate.html"
                  target="_blank">sklearn.cross_validate()</a>
                Evaluate metric(by <code>cross-validation</code> and also record fit/score times.</p>
            <p><a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html" target="_blank">np.mean()</a>
                Compute the arithmetic mean along the specified axis.</p>
            <p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Ridge.html"
                  target="_blank">sklearn.RidgeRegression()</a>
                Linear least squares with l2 regularization.</p>
            <p>
                <a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Ridge.html#sklearn.linear_model.Ridge.fit"
                   target="_blank">sklearn.fit()</a>
                Fit Ridge egression model.</p>
            <p>
                <a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Ridge.html#sklearn.linear_model.Ridge.predict"
                   target="_blank">sklearn.predict()</a>
                Predict using the linear model.</p>
            <p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.mean_squared_error.html"
                  target="_blank">sklearn.mean_squared_error()</a>
                Mean squared error regression loss.</p>
            <p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html"
                  target="_blank">sklearn.PolynomialFeatures()</a>
                Generate polynomial and interaction features.</p>
            <p>
                <a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html#sklearn.preprocessing.PolynomialFeatures.fit_transform"
                   target="_blank">sklearn.fit_transform()</a>
                Fit to data, then transform it.</p>

        </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[0]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import necessary libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span
                                    class="nn">plt</span>
<span class="kn">from</span> <span class="nn">prettytable</span> <span class="kn">import</span> <span class="n">PrettyTable</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span
                                    class="n">Ridge</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span
                                    class="n">cross_validate</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span
                                    class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span
                                    class="n">PolynomialFeatures</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[0]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Initialising required parameters</span>

<span class="c1"># The list of random states</span>
<span class="n">ran_state</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span
                                    class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span
                                    class="mi">21</span><span class="p">,</span> <span class="mi">42</span><span
                                    class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span
                                    class="mi">109</span><span class="p">,</span> <span class="mi">310</span><span
                                    class="p">,</span> <span class="mi">1969</span><span class="p">]</span>

<span class="c1"># The list of alpha for regularization</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-7</span><span
                                    class="p">,</span><span class="mf">1e-5</span><span class="p">,</span> <span
                                    class="mf">1e-3</span><span class="p">,</span> <span class="mf">0.01</span><span
                                    class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span
                                    class="mi">1</span><span class="p">]</span>

<span class="c1"># The degree of the polynomial</span>
<span class="n">degree</span><span class="o">=</span> <span class="mi">30</span>
    
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[0]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Read the file &#39;polynomial50.csv&#39; as a dataframe</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span
                                    class="p">(</span><span class="s1">&#39;polynomial50.csv&#39;</span><span class="p">)</span>

<span class="c1"># Assign the values of the &#39;x&#39; column as the predictor</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;x&#39;</span><span
                                    class="p">]]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Assign the values of the &#39;y&#39; column as the response</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span
                                    class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Also assign the true value of the function (column &#39;f&#39;) to the variable f </span>
<span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span
                                    class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[0]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Helper code below to visualise the distribution of the x, y values &amp; also the value of the true function f</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span
                                    class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># Plot x vs y values</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span
                                    class="n">x</span><span class="p">,</span><span class="n">y</span><span
                                    class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span
                                    class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Observed values&#39;</span><span
                                    class="p">,</span><span class="n">markersize</span><span class="o">=</span><span
                                    class="mi">10</span> <span class="p">,</span><span class="n">color</span> <span
                                    class="o">=</span> <span class="s1">&#39;Darkblue&#39;</span><span
                                    class="p">)</span>

<span class="c1"># Plot x vs true function value</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span
                                    class="n">x</span><span class="p">,</span><span class="n">f</span><span
                                    class="p">,</span> <span class="s1">&#39;k-&#39;</span><span
                                    class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span
                                    class="s1">&#39;True function&#39;</span><span class="p">,</span><span class="n">linewidth</span><span
                                    class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">color</span> <span
                                    class="o">=</span><span class="s1">&#39;#9FC131FF&#39;</span><span
                                    class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span
                                    class="o">=</span> <span class="s1">&#39;best&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span
                                    class="s1">&#39;Predictor - $X$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span
                                    class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span
                                    class="s1">&#39;Response - $Y$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span
                                    class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span
                                    class="s1">&#39;Predictor vs Response plot&#39;</span><span class="p">,</span><span
                                    class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span
                                    class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[0]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Function to perform regularization with simple validation</span>
<span class="k">def</span> <span class="nf">reg_with_validation</span><span class="p">(</span><span
                                    class="n">rs</span><span class="p">):</span>
    
    <span class="c1"># Split the data into train and validation sets with train size </span>
    <span class="c1"># as 80% and random_state as the value given as the function parameter</span>
    <span class="n">x_train</span><span class="p">,</span> <span class="n">x_val</span><span class="p">,</span> <span
                                    class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span
                                    class="o">=</span> <span class="n">train_test_split</span><span
                                    class="p">(</span><span class="n">x</span><span class="p">,</span><span
                                    class="n">y</span><span class="p">,</span> <span class="n">train_size</span> <span
                                    class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span
                                    class="n">random_state</span><span class="o">=</span><span class="n">rs</span><span
                                    class="p">)</span>

    <span class="c1"># Create two lists for training and validation error</span>
    <span class="n">training_error</span><span class="p">,</span> <span class="n">validation_error</span> <span
                                    class="o">=</span> <span class="p">[],[]</span>

    <span class="c1"># Compute the polynomial features for the train and validation sets</span>
    <span class="n">x_poly_train</span> <span class="o">=</span> <span class="n">___</span>
    <span class="n">x_poly_val</span><span class="o">=</span> <span class="n">___</span>

    <span class="c1"># Run a loop for all alpha values</span>
    <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span
                                    class="n">alphas</span><span class="p">:</span>

        <span class="c1"># Initialise a Ridge regression model by specifying the current</span>
        <span class="c1"># alpha and with fit_intercept=False</span>
        <span class="n">ridge_reg</span> <span class="o">=</span> <span class="n">___</span>
        
        <span class="c1"># Fit on the modified training data</span>
        <span class="n">___</span>

        <span class="c1"># Predict on the training set </span>
        <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">___</span>
        
        <span class="c1"># Predict on the validation set </span>
        <span class="n">y_val_pred</span> <span class="o">=</span> <span class="n">___</span>
        
        <span class="c1"># Compute the training and validation mean squared errors</span>
        <span class="n">mse_train</span> <span class="o">=</span> <span class="n">___</span>
        <span class="n">mse_val</span> <span class="o">=</span> <span class="n">___</span>

        <span class="c1"># Append the MSEs to their respective lists </span>
        <span class="n">training_error</span><span class="o">.</span><span class="n">append</span><span
                                    class="p">(</span><span class="n">mse_train</span><span class="p">)</span>
        <span class="n">validation_error</span><span class="o">.</span><span class="n">append</span><span
                                    class="p">(</span><span class="n">mse_val</span><span class="p">)</span>
    
    <span class="c1"># Return the train and validation MSE</span>
    <span class="k">return</span> <span class="n">training_error</span><span class="p">,</span> <span class="n">validation_error</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[0]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### edTest(test_validation) ###</span>
<span class="c1"># Initialise a list to store the best alpha using simple validation for varying random states</span>
<span class="n">best_alpha</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Run a loop for different random_states</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span
                                    class="p">(</span><span class="nb">len</span><span class="p">(</span><span
                                    class="n">ran_state</span><span class="p">)):</span>
    
    <span class="c1"># Get the train and validation error by calling the </span>
    <span class="c1"># function reg_with_validation</span>
    <span class="n">training_error</span><span class="p">,</span> <span class="n">validation_error</span> <span
                                    class="o">=</span> <span class="n">___</span>

    <span class="c1"># Get the best mse from the validation_error list</span>
    <span class="n">best_mse</span>  <span class="o">=</span> <span class="n">___</span>
    
    <span class="c1"># Get the best alpha value based on the best mse</span>
    <span class="n">best_parameter</span> <span class="o">=</span> <span class="n">___</span>
    
    <span class="c1"># Append the best alpha to the list</span>
    <span class="n">best_alpha</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span
                                    class="n">best_parameter</span><span class="p">)</span>
    
    <span class="c1"># Use the helper code given below to plot the graphs</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span
                                    class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span
                                    class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span
                                    class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span
                                    class="p">))</span>
    
    <span class="c1"># Plot the training errors for each alpha value</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alphas</span><span
                                    class="p">,</span><span class="n">training_error</span><span class="p">,</span><span
                                    class="s1">&#39;s--&#39;</span><span class="p">,</span> <span class="n">label</span> <span
                                    class="o">=</span> <span class="s1">&#39;Training error&#39;</span><span
                                    class="p">,</span><span class="n">color</span> <span class="o">=</span> <span
                                    class="s1">&#39;Darkblue&#39;</span><span class="p">,</span><span class="n">linewidth</span><span
                                    class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># Plot the validation errors for each alpha value</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alphas</span><span
                                    class="p">,</span><span class="n">validation_error</span><span
                                    class="p">,</span><span class="s1">&#39;s-&#39;</span><span class="p">,</span> <span
                                    class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Validation error&#39;</span><span
                                    class="p">,</span><span class="n">color</span> <span class="o">=</span><span
                                    class="s1">&#39;#9FC131FF&#39;</span><span class="p">,</span><span class="n">linewidth</span><span
                                    class="o">=</span><span class="mi">2</span> <span class="p">)</span>

    <span class="c1"># Draw a vertical line at the best parameter</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span
                                    class="n">best_parameter</span><span class="p">,</span> <span
                                    class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span
                                    class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span
                                    class="s1">&#39;r&#39;</span><span class="p">,</span> <span
                                    class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span
                                    class="s1">&#39;Min validation error at alpha = </span><span
                                    class="si">{</span><span class="n">best_parameter</span><span
                                    class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span
                                    class="s1">&#39;Value of Alpha&#39;</span><span class="p">,</span><span class="n">fontsize</span><span
                                    class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span
                                    class="s1">&#39;Mean Squared Error&#39;</span><span class="p">,</span><span
                                    class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span
                                    class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span
                                    class="mi">0</span><span class="p">,</span><span class="mf">0.010</span><span
                                    class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span
                                    class="n">loc</span> <span class="o">=</span> <span
                                    class="s1">&#39;upper left&#39;</span><span class="p">,</span><span class="n">fontsize</span><span
                                    class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">bm</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span
                                    class="n">best_mse</span><span class="p">,</span> <span class="mi">5</span><span
                                    class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span
                                    class="sa">f</span><span class="s1">&#39;Best alpha is </span><span
                                    class="si">{</span><span class="n">best_parameter</span><span
                                    class="si">}</span><span class="s1"> with mse </span><span class="si">{</span><span
                                    class="n">bm</span><span class="si">}</span><span class="s1">&#39;</span><span
                                    class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span
                                    class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span
                                    class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[0]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Function to perform regularization with cross validation</span>
<span class="k">def</span> <span class="nf">reg_with_cross_validation</span><span class="p">(</span><span
                                    class="n">rs</span><span class="p">):</span>
    
    <span class="c1"># Sample the data to get different splits using the random state</span>
    <span class="n">df_new</span> <span class="o">=</span> <span class="n">___</span>
    
    <span class="c1"># Assign the values of the &#39;x&#39; column as the predictor from your sampled dataframe</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">df_new</span><span class="p">[[</span><span
                                    class="s1">&#39;x&#39;</span><span class="p">]]</span><span class="o">.</span><span
                                    class="n">values</span>

    <span class="c1"># Assign the values of the &#39;y&#39; column as the response from your sampled dataframe</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df_new</span><span class="p">[</span><span
                                    class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span
                                    class="n">values</span>

    <span class="c1"># Create two lists for training and validation error</span>
    <span class="n">training_error</span><span class="p">,</span> <span class="n">validation_error</span> <span
                                    class="o">=</span> <span class="p">[],[]</span>

    <span class="c1"># Compute the polynomial features on the entire data</span>
    <span class="n">x_poly</span> <span class="o">=</span> <span class="n">___</span>

    <span class="c1"># Run a loop for all alpha values</span>
    <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span
                                    class="n">alphas</span><span class="p">:</span>

        <span class="c1"># Initialise a Ridge regression model by specifying the alpha value and with fit_intercept=False</span>
        <span class="n">ridge_reg</span> <span class="o">=</span> <span class="n">___</span>
        
        <span class="c1"># Perform cross validation on the modified data with neg_mean_squared_error as the scoring parameter and cv=5</span>
        <span class="c1"># Set return_train_score to True</span>
        <span class="n">ridge_cv</span> <span class="o">=</span> <span class="n">___</span>

        <span class="c1"># Compute the training and validation errors got after cross validation</span>
        <span class="n">mse_train</span> <span class="o">=</span> <span class="n">___</span>
        <span class="n">mse_val</span> <span class="o">=</span> <span class="n">___</span>
        
        <span class="c1"># Append the MSEs to their respective lists </span>
        <span class="n">training_error</span><span class="o">.</span><span class="n">append</span><span
                                    class="p">(</span><span class="n">mse_train</span><span class="p">)</span>
        <span class="n">validation_error</span><span class="o">.</span><span class="n">append</span><span
                                    class="p">(</span><span class="n">mse_val</span><span class="p">)</span>
    
    <span class="c1"># Return the train and validation MSE</span>
    <span class="k">return</span> <span class="n">training_error</span><span class="p">,</span> <span class="n">validation_error</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[0]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### edTest(test_cross_validation) ###</span>
<span class="c1"># Initialise a list to store the best alpha using cross validation for varying random states</span>
<span class="n">best_cv_alpha</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Run a loop for different random_states</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span
                                    class="p">(</span><span class="nb">len</span><span class="p">(</span><span
                                    class="n">ran_state</span><span class="p">)):</span>
    
    <span class="c1"># Get the train and validation error by calling the function reg_with_cross_validation</span>
    <span class="n">training_error</span><span class="p">,</span> <span class="n">validation_error</span> <span
                                    class="o">=</span> <span class="n">___</span>
    
    <span class="c1"># Get the best mse from the validation_error list</span>
    <span class="n">best_mse</span>  <span class="o">=</span> <span class="n">___</span>
    
    <span class="c1"># Get the best alpha value based on the best mse</span>
    <span class="n">best_parameter</span> <span class="o">=</span> <span class="n">___</span>
    
    <span class="c1"># Append the best alpha to the list</span>
    <span class="n">best_cv_alpha</span><span class="o">.</span><span class="n">append</span><span
                                    class="p">(</span><span class="n">___</span><span class="p">)</span>
    
    <span class="c1"># Use the helper code given below to plot the graphs</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span
                                    class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span
                                    class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span
                                    class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span
                                    class="p">))</span>
    
    <span class="c1"># Plot the training errors for each alpha value</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alphas</span><span
                                    class="p">,</span><span class="n">training_error</span><span class="p">,</span><span
                                    class="s1">&#39;s--&#39;</span><span class="p">,</span> <span class="n">label</span> <span
                                    class="o">=</span> <span class="s1">&#39;Training error&#39;</span><span
                                    class="p">,</span><span class="n">color</span> <span class="o">=</span> <span
                                    class="s1">&#39;Darkblue&#39;</span><span class="p">,</span><span class="n">linewidth</span><span
                                    class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># Plot the validation errors for each alpha value</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alphas</span><span
                                    class="p">,</span><span class="n">validation_error</span><span
                                    class="p">,</span><span class="s1">&#39;s-&#39;</span><span class="p">,</span> <span
                                    class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Validation error&#39;</span><span
                                    class="p">,</span><span class="n">color</span> <span class="o">=</span><span
                                    class="s1">&#39;#9FC131FF&#39;</span><span class="p">,</span><span class="n">linewidth</span><span
                                    class="o">=</span><span class="mi">2</span> <span class="p">)</span>

    <span class="c1"># Draw a vertical line at the best parameter</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span
                                    class="n">best_parameter</span><span class="p">,</span> <span
                                    class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span
                                    class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span
                                    class="s1">&#39;r&#39;</span><span class="p">,</span> <span
                                    class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span
                                    class="s1">&#39;Min validation error at alpha = </span><span
                                    class="si">{</span><span class="n">best_parameter</span><span
                                    class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span
                                    class="s1">&#39;Value of Alpha&#39;</span><span class="p">,</span><span class="n">fontsize</span><span
                                    class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span
                                    class="s1">&#39;Mean Squared Error&#39;</span><span class="p">,</span><span
                                    class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span
                                    class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span
                                    class="n">loc</span> <span class="o">=</span> <span
                                    class="s1">&#39;upper left&#39;</span><span class="p">,</span><span class="n">fontsize</span><span
                                    class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">bm</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span
                                    class="n">best_mse</span><span class="p">,</span> <span class="mi">5</span><span
                                    class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span
                                    class="sa">f</span><span class="s1">&#39;Best alpha is </span><span
                                    class="si">{</span><span class="n">best_parameter</span><span
                                    class="si">}</span><span class="s1"> with mse </span><span class="si">{</span><span
                                    class="n">bm</span><span class="si">}</span><span class="s1">&#39;</span><span
                                    class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span
                                    class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span
                                    class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[0]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Helper code to print your findings</span>
<span class="n">pt</span> <span class="o">=</span> <span class="n">PrettyTable</span><span class="p">()</span>

<span class="n">pt</span><span class="o">.</span><span class="n">field_names</span> <span class="o">=</span> <span
                                    class="p">[</span><span class="s2">&quot;Random State&quot;</span><span
                                    class="p">,</span> <span
                                    class="s2">&quot;Best Alpha with Validation&quot;</span><span
                                    class="p">,</span> <span
                                    class="s2">&quot;Best Alpha with Cross-Validation&quot;</span><span
                                    class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span
                                    class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">pt</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span
                                    class="n">ran_state</span><span class="p">[</span><span class="n">i</span><span
                                    class="p">],</span> <span class="n">best_alpha</span><span class="p">[</span><span
                                    class="n">i</span><span class="p">],</span> <span
                                    class="n">best_cv_alpha</span><span class="p">[</span><span class="n">i</span><span
                                    class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="jp-Cell-inputWrapper">
        <div class="jp-InputPrompt jp-InputArea-prompt">
        </div>
        <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
            <h4 id="&#9208;-Comment-on-the-results-of-regularization-with-simple-validation-and-cross-validation-after-changing-the-random-state-and-alpha-values.">
                &#9208; Comment on the results of regularization with simple validation and cross-validation after
                changing the random state and alpha values.<a class="anchor-link"
                                                              href="#&#9208;-Comment-on-the-results-of-regularization-with-simple-validation-and-cross-validation-after-changing-the-random-state-and-alpha-values.">&#182;</a>
            </h4>
        </div>
    </div>
    <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
            <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[0]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                    <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">### edTest(test_chow1) ###</span>
<span class="c1"># Submit an answer choice as a string below </span>
<span class="n">answer1</span> <span class="o">=</span> <span class="s1">&#39;___&#39;</span>
</pre>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>


    </body>
    <script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
        var mathjaxscript = document.createElement('script');
        mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
        mathjaxscript.type = 'text/javascript';
        mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
        mathjaxscript[(window.opera ? "innerHTML" : "text")] =
            "MathJax.Hub.Config({" +
            "    config: ['MMLorHTML.js']," +
            "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
            "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
            "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
            "    displayAlign: 'center'," +
            "    displayIndent: '0em'," +
            "    showMathMenu: true," +
            "    tex2jax: { " +
            "        inlineMath: [ ['$','$'] ], " +
            "        displayMath: [ ['$$','$$'] ]," +
            "        processEscapes: true," +
            "        preview: 'TeX'," +
            "    }, " +
            "    'HTML-CSS': { " +
            " linebreaks: { automatic: true, width: '95% container' }, " +
            "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
            "    } " +
            "}); ";
        (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
    }
    </script>
</main>

<footer class="footer">
    <div class="container">
    <span class="text-muted">Copyright 2018 &copy;
      <a class="text-muted" href="https://iacs.seas.harvard.edu/">Institute for Applied Computational Science</a>
    </span>
    </div>
</footer>     <!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script
        src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"
></script>
<script
        src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"
        integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T"
        crossorigin="anonymous"
></script>
</body>
</html>